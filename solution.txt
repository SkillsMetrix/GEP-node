
const express= require('express')
const bp= require('body-parser')
const jwt= require('jsonwebtoken')
const config= require('./config.json')

const router= express.Router()

const app=express()
app.use(bp.json())

router.post('/login',(req,res)=>{
    postdata=req.body
    const user={
        "uname":postdata.uname,
        "email":postdata.email
    }
    const token=jwt.sign(user,config.secret,{expiresIn:config.tokenLife})
    const response={
        "status":"Logged In",
        "token":token
    }
    res.send(response)
})
router.use(require('./tokenChecker'))
router.get("/secure",(req,res)=>{
    res.send('Secured URL is Active')
})
app.use('/api',router)
app.listen(4000,()=>{
    console.log('server is ready');
    
})
